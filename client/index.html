<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Service Request Analysis NewYork</title>

        <link rel="stylesheet" href="/css/steuerelement.css">
        <link rel="stylesheet" href="/css/master.css">
        <link rel="stylesheet" href="/css/d3.css">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js"></script>
        <script type="text/javascript" src="/js/list.js"></script>
        <script type="text/javascript" src="/js/script.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://kit.fontawesome.com/17def43369.js"></script>

        <script src="http://d3js.org/d3.v4.min.js"></script>
        <script src="//d3js.org/topojson.v1.min.js"></script>

    </head>
    <body>
        <header>
            <p>The Analysis of New York Service Requests</p>
            <a href="#about"><i class="fas fa-info-circle fa-2x"></i></a>
            <a href="#motivation"><i class="fa fa-question-circle-o fa-2x"></i></a>
        </header>
        <div class="main">
            <div class="description">
                In todays world publicly available datasets are a great possiblitiy to provide insights and a driver to make decisions. Moreover, we have to realize that many people are on the move, relocating, settling down and finding their new homes. What if not New York - the city that never sleeps - appears to be an ideal place to be analyzes as a city that reveals interesting insights about the real estate and neighborhood development in relationship to 311 Service Reports and Complaints that are reported in New York. <br><br>

                The target groups of this website are real estate investors, the residents of New York and urban city developers that may derive potential social conflicts and gain insights for future development projects. Moreover, we want to address the general public. We think that illuminating this data would be interesting to people who considering moving to New York, but especially current residents of the city.
                <br>
                <br>

                Therefore, please select one of the 3 use cases below to start a journey into the data:
                <br>
                <br>

            </div>
            <ul class="navbar" id="navbar">

            </ul>
            <div class="details">
            
                <div class="div2" style="display: none">
                    <div class="charttext">
                        New York is an eldorado for urban city planners and we are highly confident that city planners can learn a lot by correlating service requests to certain neighborhoods. Depending on how fast service claims can be resolved and how close governmental bodies are working together to get things done, the development of a specific neighborhood can be impacted.
                        <br>
                        <br>
                        For information about the data set and exclusion we recommend to check out the section "Data Sources and Exclusions" at the very bottom.
                        <br>
                        <br>
                        Let's have a look whether certain "problem neighborhoods" can be identified and whether this can derived from response times of governmental bodies!
                    </div>
                    <div class="charttext">
                        To start the analysis it needs to be understood how the volume of the calls is developing over time. As we can see New York is facing a signifant increase in Service calls over the course of the last years.

                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart reveals the amount of total service requests (on the Y-Axis) based on a quarterly basis from 2011 to 2019 (on the X-Axis).

                            <p><u>Micro-Stories</u></p>
                            In the early years we can conclude that there is a seasonal trend, which is vanishing over time.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576110827614' style='position: relative'>
                                <noscript>
                                    <a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;TimeSeriesAnalysis&#47;1_rss.png' style='border: none' /></a>
                                </noscript>
                                <object class='tableauViz'  style='display:none;'>
                                    <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                                    <param name='embed_code_version' value='3' />
                                    <param name='site_root' value='' />
                                    <param name='name' value='NYAnalysis_4&#47;TimeSeriesAnalysis' />
                                    <param name='tabs' value='no' />
                                    <param name='toolbar' value='yes' />
                                    <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;TimeSeriesAnalysis&#47;1.png' />
                                    <param name='animate_transition' value='yes' />
                                    <param name='display_static_image' value='yes' />
                                    <param name='display_spinner' value='yes' />
                                    <param name='display_overlay' value='yes' />
                                    <param name='display_count' value='yes' />
                                </object>
                            </div>
                            <script type='text/javascript'>
                            </script>
                        </div>

                    </div>
                    <div class="charttext">
                        Moreover, we have to analyze on a more detailed basis, whether patterns can be recognized. In this chart we look at the service call volume on a daily basis plus adding a trend line to give an outlook on future serivice request volume.
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart reveals the amount of total service requests (on the Y-Axis) based on a daily basis from 2011 to 2019 (on the X-Axis).

                            <p><u>Micro-Stories</u></p>
                            Peaks are being recognized in winter days, which are likely to be claims about water and heat related topics.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576112133959' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;APL_Trend&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_4&#47;APL_Trend' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;APL_Trend&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object>
                            </div>
                            <script type='text/javascript'>
                            </script>
                        </div>
                    </div>
                    <div class="charttext">
                        To get even further insights in patterns an analyis on weekday and hourly basis might be highly insightful. We observe a higher calling volume on the weekdays compared to weekend and signifant increased volume in the morning hours, which flattens out in the afternoon and peaks again in the evening hours around 10:00 pm.
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart on the left reveals the amount of total service requests (on the Y-Axis) based on weekday (on the X-Axis), whereas the right chart contains information on the hour of the day (on the X-Axis).

                            <p><u>Micro-Stories</u></p>
                             It is very likely that the type of complaint will change over the course of the day.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576112613718' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;WeekDayAnalysis&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_4&#47;WeekDayAnalysis' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;WeekDayAnalysis&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>

                            <script type='text/javascript'>
                            </script>
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576112770769' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;HourlyAnalysis&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_4&#47;HourlyAnalysis' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_4&#47;HourlyAnalysis&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object>
                            </div>

                            <script type='text/javascript'>
                            </script>
                        </div>
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart reveals the amount of total service requests (on the Y-Axis) based on a daily basis from 2011 to 2019 (on the X-Axis).

                            <p><u>Micro-Stories</u></p>
                            Peaks are being recognized in winter days, which are likely to be claims about water and heat related topics.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576113283083' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Y2&#47;Y2MTGMZY8&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;Y2MTGMZY8' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Y2&#47;Y2MTGMZY8&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object>
                            </div>
                            <script type='text/javascript'>

                            </script>
                        </div>

                    </div>
                </div>
                <div class="div3" style="display: none">
                    <div class="charttext">
                        You are living New York and want to learn more about your city or you consider moving to New York? You want a good nights sleep and don't get bothered by a noisy neighbohood? Than this is the right place for you. You can analyze your neighborhood over time and how certain districts are developing in relationship to certain complaint types.
                        <br>
                        <br>
                        For information about the data set and exclusion we recommend to check out the section "Data Sources and Exclusions" at the very bottom.
                        <br>
                        <br>
                        Let's have a look whether you can find your dream neighborhood with the fewest complaints for specific topics.
                    </div>
                    <div class="charttext">
                        To start the analysis it needs to be understood in which neighborhoods the highest the volume of the calls is taking place. As we can see New York is facing a signifant differences in the volume of service requests that have been recorded over the last 9 years.

                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart reveals the amount of total service requests based on zip code. Green represents a low volume of requests whereas red represents a high volume.

                            <p><u>Micro-Stories</u></p>
                            It appears that there are 2 hot spots for high volume of service requests - the Bronx and an area on the boarder between Brooklyn and Queens.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576147287964' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;ZipCodeAnalysis&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_5&#47;ZipCodeAnalysis' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;ZipCodeAnalysis&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object>
                            </div>
                            <script type='text/javascript'>
                            </script>
                        </div>
                    </div>
                    <div class="charttext">
                        In the next step it makes sense to overlay the volume of service requests with median household income for the neighborhoods to derive whether there is a potential correlation and there are certain areas where you might don't want to move.
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart reveals the amount of total service requests based on zip code - represented by the dots. This is overlayed in the background with median household income of households of neighborhoods. Green represents low volume of requests/ high income, red high volume/ low income.

                            <p><u>Micro-Stories</u></p>
                            It seems that there is a correlation between high request volume and low income areas.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576148141328' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;ZipCodeAnalysisIncome&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_5&#47;ZipCodeAnalysisIncome' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;ZipCodeAnalysisIncome&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>
                            <script type='text/javascript'>
                            </script>
                        </div>
                    </div>
                    <div class="charttext">
                        Let's have a deeper look into certain trend patterns over time. Maybe in certain areas the service request volume is increasing or decreasing overproportionally.
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The chart reveals the amount of total service requests based on zip code on a quarterly basis from 2011 to 2019.

                            <p><u>Micro-Stories</u></p>
                            It indeed seems to be confirmed that the 2 hot spots we identified overproportionally increased the service requests.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576149468698' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;5M&#47;5M6GX3J69&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;5M6GX3J69' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;5M&#47;5M6GX3J69&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>
                            <script type='text/javascript'>
                            </script>
                        </div>
                    </div>
                    <div class="charttext">
                        Moreover, it would be fairly interesting to how the most common complaint types in context on when and where they occur will reveal important information about your neighborhood. As we can see right away there are less complaints over the weekend and it is also interesting to analyse the complaint type structure.
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            The charts reveal the type of complaint by weekday and a geographical representation of where these complaint types occur. Areas with less than 5 complaints are exlcuded.

                            <p><u>Micro-Stories</u></p>
                            It seems that there are more noise complaints over the weekend. In contrast infrasture and building complaints are more dominant throughout the week.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576148726616' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;DailyAnalysis&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_5&#47;DailyAnalysis' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;DailyAnalysis&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>
                            <script type='text/javascript'>
                            </script>
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576148771928' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;TopTypeAnalysisTimeWeekday&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYAnalysis_5&#47;TopTypeAnalysisTimeWeekday' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYAnalysis_5&#47;TopTypeAnalysisTimeWeekday&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>
                            <script type='text/javascript'>
                            </script>
                        </div>
                    </div>
                    <div class="charttext">
                        Finally you might want to get insights about the daily strucutre of those complaints.
                    </div>
                    <div class="chart">
                        <div class="innertext">
                            <p><u>Navigating the Data</u></p>
                            By hovering over the Hour of the Day (0 - 23) the respective hour is selected and represents the most common complaint types in a specific area.

                            <p><u>Micro-Stories</u></p>
                            You can identify areas that have a high amount of noise complaints - especially in the evening hours. For a good night sleep you might want to avoid those neighborhoods.
                        </div>
                        <div class="innerchart">
                            <div class='tableauPlaceholder' id='viz1576149896137' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;6R&#47;6RH9P7JBW&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;6RH9P7JBW' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;6R&#47;6RH9P7JBW&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>
                            <script type='text/javascript'>
                            </script>>
                        </div>
                    </div>



                    <div class="charttext">
                        If you have still open questions feel free to use our interactive 311-dashboard below to get all the answers you are looking for:
                        <br>
                        <br>

                    </div>
                </div>
            </div>

            <div class="d3">
                <svg id="xbox" width="300" height="200" style="background: rgb(30,30,30)"></svg>
                <svg id="topfloat" width="1000" height="200" style="background: rgb(30,30,30)"></svg>
                <svg id="sidebar" width="300" height="1000" style="background: rgb(30,30,30)"></svg>
                <svg id="canvas" width="1000" height="1000" style="background: rgb(30,30,30)"></svg>

                <script type="text/javascript">

                var xglob;
                var yglob;
                // grab graphic components
                var xbox = d3.select("#xbox")
                var topfloat = d3.select("#topfloat")
                var canvas = d3.select("#canvas")
                var sidebar = d3.select("#sidebar")

                var agency = "All"
                var month = "All"

                // width and height of main canvas
                var w = 1000;
                var h = 1000;

                var divn = d3.select("body").append("div")
                  .attr("class", "tooltip")
                  .style("opacity", 0)

                  // top left corner just a title box
                xbox
                  .selectAll("text")
                  .data([["NYC", 40, 50], ["311", 90, 115], ["Calls", 135, 175]])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", (d, i) => {return d[1]})
                  .attr("y", (d, i) => {return d[2]})
                  .style("text-anchor", "right")
                  .style("font-size", 60)
                  .attr("fill", "#fff")



                // functions related to topfloat area
                // draw text items for click functions
                /*
                var boros = topfloat
                  .selectAll("text")
                  .data([["NYC", 25], ["Bronx", 75],["Manhattan", 145], ["Brooklyn", 225], ["Queens", 295], ["StatenIsland", 375]])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("class", (d) => d[0] + " boro")
                  .attr("x", (d) => { return d[1]})
                  .attr("y", 12)
                  .style("text-anchor", "middle")
                  .style("font-size", 14)
                  .attr("fill", (d) => {return d[0] == "NYC" ? "#fff" : "#424242"})
                  .on("click", function() {
                    d3.selectAll(".borofill").style("fill", "#333333")
                  })
                  */

                // main canvas loading /////////////////////////

                canvas
                  .selectAll("text")
                  .data([["New York City", 50], ["Pop. 8,398,748", 95]])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 150)
                  .attr("y", (d, i) => { return d[1]})
                  .style("text-anchor", "middle")
                  .style("font-size", (d) => { return d[1] == 95 ? 20 : 30})
                  .attr("fill", "#fff")

                var agencyFilter = canvas
                    .append("g")
                    .selectAll("text")
                    .data([["Filter by Agency",0],
                          ["All",1],
                          ["DOHMH",2],
                          ["NYPD",3],
                          ["DEP",4],
                          ["DSNY",5],
                          ["DOT",6],
                          ["HPD",7],
                          ["DOB",8],
                          ["DPR",9],
                          ["TLC",10],
                          ["DHS",11],
                          ["DOF",12],
                          ["DCA",13],
                          ["EDC",14],
                          ["DOE",15],
                          ["DOITT",16],
                          ["DFTA",17]])
                    .enter()
                    .append("text")
                    .text((d) => d[0])
                    .attr("x", 925)
                    .attr("y", (d, i) => { return i * 20 + 20})
                    .attr("class", (d) => {return d[0] == "Filter by Agency" ? "filterTitle" : "agencyFilter"})
                    .style("text-anchor", "middle")
                    .style("font-size", (d) => {return d[0] == "Filter by Agency" ?  18 : 12})
                    .attr("fill", (d) => {return d[0] == "Filter by Agency" || d[0] == "All" ? "#fff" : "#424242"})
                    .on("click", function() {
                      var agencySelection = d3.select(this);
                      agency = agencySelection._groups[0][0].innerHTML

                      d3.selectAll(".agencyFilter").attr("fill", "#424242")

                      agencyFilter
                        .filter((d) => d[0] == agency || d[0] == "Filter by Agency")
                        .attr("fill", "#fff")

                      canvas
                        .selectAll(".crc")
                        .style("opacity", function(d){
                          if (agency == "All" && month == "All") return .8
                          if (agency == "All" && monthMap[d["Month"]] == month) return .8
                          if(d["Agency"] != agency) {return 0}
                          else {
                            if (monthMap[d["Month"]] == month || month == "All") {
                              return .8
                            } else {
                              return 0
                            }
                          }
                        })

                    })

                  var monthMap = {1:"Jan", 2:"Feb", 3:"Mar", 4:"Apr", 5:"May",6:"Jun",7:"Jul", 8:"Aug", 9:"Sep",10:"Oct", 11:"Nov",12:"Dec"}
                  var monthFilter = canvas
                    .append("g")
                    .selectAll("text")
                    .data([["Filter by Month",0],
                          ["All",1],
                          ["Jan",2],
                          ["Feb",3],
                          ["Mar",4],
                          ["Apr",5],
                          ["May",6],
                          ["Jun",7],
                          ["Jul",8],
                          ["Aug",9],
                          ["Sep",10],
                          ["Oct",11],
                          ["Nov",12]])
                    .enter()
                    .append("text")
                    .text((d) => d[0])
                    .attr("x", 925)
                    .attr("y", (d, i) => { return i * 20 + 500})
                    .attr("class", (d) => {return d[0] == "Filter by Month" ? "filterTitle" : "monthFilter"})
                    .style("text-anchor", "middle")
                    .style("font-size", (d) => {return d[0] == "Filter by Month" ?  18 : 12})
                    .attr("fill", (d) => {return d[0] == "Filter by Month" || d[0] == "All" ? "#fff" : "#424242"})
                    .on("click", function() {
                      var monthSelection = d3.select(this);
                      month = monthSelection._groups[0][0].innerHTML

                      d3.selectAll(".monthFilter").attr("fill", "#424242")

                      monthFilter
                        .filter((d) => d[0] == month || d[0] == "Filter by Month")
                        .attr("fill", "#fff")

                      canvas
                        .selectAll(".crc")
                        .style("opacity", function(d){
                          if (month == "All" && agency == "All") return .8
                          if (month == "All" && d["Agency"] == agency) return .8
                          if (monthMap[d["Month"]] != month) {return 0}
                          else {
                            if (d["Agency"] == agency || agency == "All") {
                            return .8
                          } else {
                            return 0
                          }
                        }
                      })

                    })


                // define projection and center on nyc
                var projection = d3.geoConicEqualArea()
                                  .parallels([40, 41])
                                  .scale(110000)
                                  .translate([w/2, h/2])
                                  .rotate([96, 0])
                                  .center([22.05, 40.68]);

                // define path generator
                var path = d3.geoPath()
                            .projection(projection);

                // %%%%%%%%%%%%%% change color map here
                var coroColor = {
                  "animal":"#ffff4d",
                  "building":"#66a3ff",
                  "construction":"#ffb833",
                  "hazard":"#99e699",
                  "homeless":"#e066ff",
                  "infractions":"#0033ff",
                  "noise":"#ff5c33",
                  "other":"#4ddbff",
                  "roadways":"#ff8095",
                  "taxi":"#b30000",
                  "vehicle":"#f2f2f2",
                  "water":"#ccff66"
                }

                var legend = canvas
                  .append("g")
                  .selectAll("text")
                  .data([
                    ["animal","#ffff4d"],
                    ["building","#66a3ff"],
                    ["construction","#ffb833"],
                    ["hazard","#99e699"],
                    ["homeless","#e066ff"],
                    ["infractions","#0033ff"],
                    ["noise","#ff5c33"],
                    ["other","#4ddbff"],
                    ["roadways","#ff8095"],
                    ["taxi","#b30000"],
                    ["vehicle","#f2f2f2"],
                    ["water","#ccff66"]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 50)
                  .attr("y", (d, i) => { return i * 20 + 200})
                  .attr("class", "lgd")
                  .style("text-anchor", "left")
                  .style("font-size", 12)
                  .attr("fill", "#fff")


                  var legendCircles = canvas
                    .append("g")
                    .selectAll("circle")
                    .data([
                    ["animal","#ffff4d"],
                    ["building","#66a3ff"],
                    ["construction","#ffb833"],
                    ["hazard","#99e699"],
                    ["homeless","#e066ff"],
                    ["infractions","#0033ff"],
                    ["noise","#ff5c33"],
                    ["other","#4ddbff"],
                    ["roadways","#ff8095"],
                    ["taxi","#b30000"],
                    ["vehicle","#f2f2f2"],
                    ["water","#ccff66"]
                    ])
                    .enter()
                    .append("circle")
                    .attr("cx", 40)
                    .attr("cy", (d, i) => { return i * 20 + 196})
                    .attr("r", 6)
                    .attr("fill", (d) => d[1])
                    .style("opacity", .8)

                  canvas
                  .append("g")
                  .selectAll("text")
                  .data([
                    ["Manhattan"]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 332)
                  .attr("y", (d, i) => { return 300})
                  .style("text-anchor", "left")
                  .style("font-size", 12)
                  .attr("fill", "#fff")

                  canvas
                  .append("g")
                  .selectAll("text")
                  .data([
                    ["Queens"]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 750)
                  .attr("y", (d, i) => { return 230})
                  .style("text-anchor", "left")
                  .style("font-size", 12)
                  .attr("fill", "#fff")

                  canvas
                  .append("g")
                  .selectAll("text")
                  .data([
                    ["Bronx"]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 550)
                  .attr("y", (d, i) => { return 30})
                  .style("text-anchor", "left")
                  .style("font-size", 12)
                  .attr("fill", "#fff")

                  canvas
                  .append("g")
                  .selectAll("text")
                  .data([
                    ["Staten Island"]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 200)
                  .attr("y", (d, i) => { return 620})
                  .style("text-anchor", "left")
                  .style("font-size", 12)
                  .attr("fill", "#fff")

                  canvas
                  .append("g")
                  .selectAll("text")
                  .data([
                    ["Brooklyn"]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 350)
                  .attr("y", (d, i) => { return 565})
                  .style("text-anchor", "left")
                  .style("font-size", 12)
                  .attr("fill", "#fff")

                /*var ordColor = d3.scaleOrdinal(d3.schemeCategory20) */

                // write in main text
                sidebar
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["Navigating the Data", 1],
                  ["Our data cuts along a few dimensions.",0],
                  ["Colors reveal the type of complaint.",0],
                  ["The filters allow you to slice along time and",0],
                  ["by agencies of interest. The map allows you",0],
                  ["to reason about all of this spatially.", 0],
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 5)
                  .attr("y", (d, i) => {return i * 25 + 30})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  sidebar
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["Micro-Stories",1],
                  ["Our data revealed stories to investigate.",0],
                  ["There're many to explore. Here're a few to",0],
                  ["get started.",0]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 5)
                  .attr("y", (d, i) => {return i * 25 + 220})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  sidebar
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["Tourists lose things in taxis...",2],
                  ["Take a look at TLC during the summer.",0]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 5)
                  .attr("y", (d, i) => {return i * 25 + 350})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-style", "italic")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  sidebar
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["It's noisy along the east river...",2],
                  ["Look at NYPD claims in Harlem and the Bronx.",0],
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 5)
                  .attr("y", (d, i) => {return i * 25 + 425})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-style", "italic")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  sidebar
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["Lower manhattan sees the most claims related", 2],
                  ["to homelessness...",2],
                  ["Check out claims made to DHS.",0]
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 5)
                  .attr("y", (d, i) => {return i * 25 + 500})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-style", "italic")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  topfloat
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["This data represents calls made to ", 0],
                  ["New York's 311 service.",0],
                  ["The 311 service fields many different",0],
                  ["types of calls from noise to lost",0],
                  ["property to rodents and pests.",0],
                  ["The calls are as diverse as the city.",0],
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 25)
                  .attr("y", (d, i) => {return i * 25 + 40})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  topfloat
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["New York is composed of five boroughs.", 0],
                  ["Manhattan is often the most recognized,",0],
                  ["with Brooklyn, the Bronx, and Queens not ",0],
                  ["far behind. Staten Island is the least ",0],
                  ["known further away from the city, but has",0],
                  ["its own unique apsects and attractions.",0],
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 325)
                  .attr("y", (d, i) => {return i * 25 + 40})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                  topfloat
                  .append("g")
                  .selectAll("text")
                  .data([
                  ["New York's boroughs contain smaller divisions.", 0],
                  ["Within each borough are neighborhoods,",0],
                  ["Each of which has its own unique",0],
                  ["characteristics. Midtown is known for",0],
                  ["Times Square, the West Village is known",0],
                  ["for brownstones, and DUMBO for its bridges.",0],
                  ])
                  .enter()
                  .append("text")
                  .text((d) => d[0])
                  .attr("x", 650)
                  .attr("y", (d, i) => {return i * 25 + 40})
                  .attr("class", "sbText")
                  .style("text-anchor", "left")
                  .style("font-size", (d) => { return d[1] == 1 ? 24 : 14})
                  .attr("fill", "#fff")

                // draw the basic map
                d3.json('/borough.geojson', function(json){
                    console.log("got geo json")


                  // bind data and create one path per geojson feature
                    canvas.selectAll("path")
                		      .data(json.features)
                				  .enter()
                				  .append("path")
                				  .attr("d", path)
                          .style("stroke", "#aaa")
                				  .style("fill", "#333333");

                  d3.csv('/dots20.csv', function(data) {
                    canvas.append("g")
                          .selectAll("circle")
                          .data(data).enter()
                          .append("circle")
                          .attr("class", (d) => {return d["Agency"] + " crc"})
                          .attr("cx", (d) => {return projection([d["Longitude"],d["Latitude"]])[0]})
                          .attr("cy", (d) => {return projection([d["Longitude"],d["Latitude"]])[1]})
                          .attr("r", 2)
                          .attr("fill", (d) => {return coroColor[d["ShrtCateg"]]})
                          .style("opacity", .6)
                          .on("mouseover", function(d){
                            var opax = d3.select(this)

                            if (opax._groups[0][0].style.opacity != "0") {
                            divn.transition()
                              .duration(10)
                              .style("opacity", .9)
                            divn.html("<strong> Agency: " + d.Agency + "<strong><br>" +
                              "<strong> Date: " + d["Created Date"] + "<strong><br>" +
                                "<strong> Complaint: " + d["Complaint Type"] + "<strong><br>" )
                              .style("left", (d3.event.pageX + 5) + "px")
                              .style("top", (d3.event.pageY - 50) + "px")
                                }
                            })
                          .on("mouseout", function(d){
                            divn.transition()
                                .duration(500)
                                .style("opacity", 0)
                            })
                        })
                })

                </script>
            </div>
            <div class="text about" id="about">
                <p>About Us</p>
                We are an aspiring young team consisting out of 3 Berkeley Students:<br><br>
                Karl Siil <br>
                Josh Smith <br>
                Christoph Jentzsch <br>
                <br>
                Our mission is to make data talk and provide interesting insights about the city of New York.
                <br>
                <br>
                <br>
                <br>

            </div>
            <div class="text motivation" id="motivation">
                <p>Data Sources and Exclusions</p>
                This data set contains out of 2 different data sources.
                <br>
                <br>
                The first data set is about New York Service Request and contains 21 million protocolled complaints. It captures almost 10 years of data from 2010 to 2019. Given the sheer amount of data we had to apply certain exlusions.
                <br>

                <p style="text-indent:20px; font-size:30px"> <u>Exclusions</u></p>
                - Data with a missing or invalid time stamp, when the service claim was recorded<br>
                - Service claims that had a invalid claim closing time duration (e.g. negative claim closing time or 0 mins)<br>
                - Every zip code with less than 1000 service requests (in total) over the last 10 years was excluded<br>
                - Complaint Type that were invalid or driven by erroneous data entry (such as ".../....///.../...///.../...")<br>
                - The year 2010 was exlcuded<br>
                - All service requests after Q3 2019 have been exluded <br>

                <p style="text-indent:20px; font-size:30px"> <u>Data Source</u></p>
                https://nycopendata.socrata.com/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9<br>

                <br>
                <br>
                The second data set is derived from Zillow as it contains the real estate price development over the last 10 years for almost any neighborhood respective zip code within New York area.
                <br>

                <p style="text-indent:20px; font-size:30px"> <u>Exclusions</u></p>
                - Zip codes that were not in the boundaries of any New Yor borough<br>

                <p style="text-indent:20px; font-size:30px"> <u>Data Source</u></p>
                https://www.zillow.com/new-york-ny/home-values/<br>

            </div>
        </div>
        <footer>
            <div class="wrapper">
                <div class="left">
                    1600 Pennsylvania Ave NW,<br>
                    Washington, DC 20500,<br>
                    Vereinigte Staaten
                </div>
                <div class="middle">

                </div>
                <div class="right">

                </div>
            </div>
            <p>© Exapemlebrand</p>
        </footer>
    </body>
</html>
